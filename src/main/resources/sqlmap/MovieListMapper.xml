<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.class4.movieList.mapper.MovieListMapper">

	<select id="cMovieList" resultType="MovieListVO">
		<![CDATA[  
		select *
		from(select rownum as rn,
   				 c.*
				from(select a.*,
      				 b.subhead,
       				 b.content,
       				 b.poster,
                     b.trailer
    				    from movie a
						left join moviesub b
						on a.title = b.title
						where a.opendt > sysdate-30 and a.opendt <= sysdate
						order by opendt) c 
						)
			where rn > (#{pageNum}-1) * #{amount} and rn <= #{pageNum} * #{amount}
			]]>
	
	</select>
	
	<select id="eMovieList" resultType="MovieListVO">
		<![CDATA[  
		select *
		from(select rownum as rn,
   				 c.*
				from(select a.*,
      				 b.subhead,
       				 b.content,
       				 b.poster,
                     b.trailer
    				    from movie a
						left join moviesub b
						on a.title = b.title
						where a.opendt > sysdate
						order by opendt) c 
						)
			where rn > (#{pageNum}-1) * #{amount} and rn <= #{pageNum} * #{amount}
			]]>
	
	</select>
	
	<select id="getTotalC" resultType="int">
	<![CDATA[
	select count(*) from movie where opendt > sysdate-30 and opendt <= sysdate
	]]>  
		
		
	</select>

	<select id="getMovieInfo" resultType = "MovieInfoVO">
select a.*,
      b.subhead,
  	  b.content,
  	  b.poster,
      b.trailer
	from movie a
		left join moviesub b
		on a.title = b.title
		where a.moviecd = #{cd}
	</select>

	<select id="getTotalE" resultType="int">
		select count(*) from movie where opendt > sysdate
	</select>
	
	<update id="update">
		update [테이블] set subhead = #{subhead}, content=#{content}, poster=#{poster}, trailer = #{trailer}
		where title = #{title}
	</update>
	
	<insert id="regist">
		INSERT INTO movie(movieCd, title, ftitle, grade, openDt) VALUES(#{movieCd}, #{title}, #{ftitle}, #{grade}, #{openDt})
	</insert>
	
	<select id="getCodeList" resultType="String">
		SELECT movieCd FROM movie
	</select>
	
	
	<select id="getActorCodeList" resultType="String">
		SELECT ano FROM actor
	</select>
	
	<select id="getDirectorCodeList" resultType="String">
		SELECT dno FROM director
	</select>
	
	<insert id="testActorInsert">
		INSERT INTO actor(ano, actorName) VALUES(#{ano}, #{actorName})
	</insert>
	
	<insert id="testDirectorInsert">
		INSERT INTO director(dno, directorName) VALUES(#{dno}, #{directorName})
	</insert>
	
	
	
	
	
</mapper>